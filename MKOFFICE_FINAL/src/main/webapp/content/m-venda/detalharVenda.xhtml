<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition template="/template/template_main.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="ccsImports">
	</ui:define>
	
	<ui:define name="jsImports">
		<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/javascript/menu_venda/validate_venda.js"></script>
	</ui:define>

	<ui:define name="breadcrumb">
		<ul class="breadcrumb">
			<li class="active">
				<h:commandLink action="#{loginBean.telaIndex()}" value="#{msgs['generico.breadcumb.telainicial']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{historicoVendaBean.iniciarTela()}" value="#{msgs['detalharvenda.breadcumb.venda']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{historicoVendaBean.voltarTelaHistoricoVendas()}" value="#{msgs['detalharvenda.breadcumb.venda.listarhistoricovenda']}" />
				<span class="divider">/</span>
			</li>
			<li>#{msgs['detalharvenda.breadcumb.venda.listarhistoricovenda.detalharvenda']}</li>
		</ul>
	</ui:define>

	<ui:define name="body_content">
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharvenda.lbl.legend.informacaocliente']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">	
					<h:panelGrid cellpadding="0" cellspacing="1" columns="6" style="margin-top:5px;margin-bottom:25px;">
						<h:outputLabel value="#{msgs['detalharvenda.lbl.nome']}:" for="txtNome" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtNome" value="#{historicoVendaBean.clienteVo.nome}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:panelGroup>	</h:panelGroup>
						<h:panelGroup>	</h:panelGroup>
						<h:panelGroup>	</h:panelGroup>
						<h:panelGroup>	</h:panelGroup>
		
						<h:outputLabel value="#{msgs['detalharvenda.lbl.endereco']}:" for="txtAddress" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtAddress" value="#{historicoVendaBean.clienteVo.endereco.logradouro}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.numero']}:" for="txtNum" styleClass="HtmlOutputLabelResposta"/> 
						<h:outputLabel id="txtNum" value="#{historicoVendaBean.clienteVo.endereco.numero}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.bairro']}:" for="txtBairro" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtBairro" value="#{historicoVendaBean.clienteVo.endereco.bairro}" styleClass="input-5left HtmlOutputTextResposta"  />
			
						<h:outputLabel value="#{msgs['detalharvenda.lbl.cidade']}:" for="txtCity" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtCity" value="#{historicoVendaBean.clienteVo.endereco.cidade}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.estado']}:" for="txtState" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtState" value="#{historicoVendaBean.clienteVo.endereco.estado}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.cep']}:" for="cep" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="cep" value="#{historicoVendaBean.clienteVo.endereco.cep}" styleClass="input-5left HtmlOutputTextResposta"  />
					
						<h:outputLabel value="#{msgs['detalharvenda.lbl.email']}:" for="txtEmail" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtEmail" value="#{historicoVendaBean.clienteVo.email}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.telefone']}:" for="txtTelefone" styleClass="HtmlOutputLabelResposta" style="margin-left: 10px;"/>
						<h:outputLabel id="txtTelefone" value="#{historicoVendaBean.clienteVo.numTelefoneString}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.celular']}:" for="txtTelefoneCel" styleClass="HtmlOutputLabelResposta" style="margin-left: 10px;"/>
						<h:outputLabel id="txtTelefoneCel" value="#{historicoVendaBean.clienteVo.numCelularString}" styleClass="input-5left HtmlOutputTextResposta" />
											
					</h:panelGrid>
				</div>
			</div>
		</div>
		
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharvenda.lbl.legend.informacaovenda']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">	
					<h:panelGrid cellpadding="0" cellspacing="1" columns="2" style="margin-top:5px;margin-bottom:25px;" border="0">
						<h:outputLabel value="#{msgs['detalharvenda.lbl.codigovenda']}:" for="txtCodVenda" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtCodVenda" value="#{historicoVendaBean.vendaVo.codVenda}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['detalharvenda.lbl.datavenda']}:" for="txtDataVenda" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtDataVenda" value="#{historicoVendaBean.vendaVo.dataVendaFormatado}" styleClass="input-5left HtmlOutputTextResposta" />
						
						<h:outputLabel value="#{msgs['detalharvenda.lbl.totalpontosvendidos']}:" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel value="#{historicoVendaBean.vendaVo.qtdeTotalPontosVendidos} pts" styleClass="input-5left HtmlOutputTextResposta" />
						
						<h:outputLabel value="#{msgs['detalharvenda.lbl.valortotalvenda']}:" styleClass="HtmlOutputLabelResposta"/>
						<h:panelGrid columns="2"> 
							<h:outputLabel value="R$" styleClass="input-5left HtmlOutputTextResposta" />
							<h:outputLabel value="#{historicoVendaBean.vendaVo.valorVenda}" styleClass="input-5left HtmlOutputTextResposta" >
								<f:converter converterId="decimalConverter" />
							</h:outputLabel>
						</h:panelGrid>
					</h:panelGrid>
				</div>
			</div>
		</div>
				
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharvenda.lbl.legend.informacaopagamento']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">	
					<h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="margin-top:5px;">
						<h:outputLabel value="#{msgs['detalharvenda.lbl.formapagamento']}:" for="txtFormaPagamento" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="txtFormaPagamento" value="#{historicoVendaBean.vendaVo.formaDePagamento.descFormaPgto}" styleClass="input-5left HtmlOutputTextResposta" />
					</h:panelGrid>
					
					<p:dataTable id="tableParcelas" style="width:42%"
							value="#{historicoVendaBean.vendaVo.parcelas}" var="p"
							rowKey="#{p}" rows="10"
							styleClass="dataTable"
							emptyMessage="#{msgs['detalharvenda.lbl.naohaparcelas']}" >
		
							<f:facet name="header">  
					            #{msgs['detalharvenda.titulotabela.situacaoparcelas']}
					        </f:facet>
					        
							<p:column headerText="#{msgs['generico.tabelacoluna.situacao']}">
					        	<h:outputText value="#{p.descricao} - #{p.codSituacaoParcela.descSituacao}" />
					        </p:column>
							<p:column  style="text-align: center;" headerText="#{msgs['detalharvenda.tabelacoluna.valorparcela']}" >
					        	<h:outputText value="R$"
									style="text-align: center;" />
					        	<h:outputText value="#{p.valorParcela}"
									style="text-align: center;">
									<f:converter converterId="decimalConverter" />
								</h:outputText>
					        </p:column>
							<p:column  style="text-align: center;" headerText="#{msgs['generico.tabelacoluna.datavencimento']}" >
					        	<h:outputText value="#{p.dtVencimento}" style="text-align: center;">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
					        </p:column>
							<p:column  style="text-align: center;" headerText="#{msgs['generico.tabelacoluna.datapagamento']}" >
					        	<h:outputText value="#{p.dtPagamento}" style="text-align: center;">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
					        </p:column>
							<p:column  style="text-align: center;" headerText="#{msgs['generico.tabelacoluna.status']}" width="500px">
								<p:commandLink 
									 disabled="#{p.desabilitaPagamentoParcela}"
									 value="#{p.codSituacaoParcela.descSituacao}" 
									 actionListener="#{historicoVendaBean.onclickBtnPagamentoParcela(p)}"
									 update=":formDialog:infoPagamento"
									 oncomplete="PF('dialogPagamento').show();loadMasksJQuery();" /> 
					        </p:column>
					</p:dataTable>
				</div>
			</div>
		</div>
				
		<hr class="lin"/>
		
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharvenda.lbl.legend.listaprodutosinclusospedido']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">
					<p:dataTable id="tableCatalogo"
								value="#{historicoVendaBean.vendaVo.listaProdutos}" var="result"
								rowKey="#{result}" rows="10"
								styleClass="dataTable"
								paginator="true" paginatorPosition="bottom"
								emptyMessage="#{msgs['detalharvenda.lbl.naohaprodutosnopedido']}">
				
								<p:column headerText="#{msgs['generico.tabelacoluna.codigoproutomk']}" style="text-align: center;"
										width="10%" sortBy="#{result.produto.codProduto}">
										<h:outputText value="#{result.produto.codProduto}"
											style="text-align: center;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.produto']}" width="50%" sortBy="#{result.produto.descProduto}">
									<h:outputText value="#{result.produto.descProduto}"
										style="text-align: left;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.valorunitario']}" style="text-align: center;" width="10%" 
									sortBy="#{result.produto.preco}">
									<h:outputText value="R$" style="text-align: right;" />
									<h:outputText value="#{result.produto.preco}" style="text-align: right;" >
										<f:converter converterId="decimalConverter" />
									</h:outputText>
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.quantidade']}" style="text-align: center;" width="10%" sortBy="#{result.qtdeProdutoCarrinho}" >
									<h:outputText value="#{result.qtdeProdutoCarrinho}" style="text-align: center;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.valortotal']}" style="text-align: center;" width="10%" >
									<h:outputText value="R$" style="text-align: right;" />
									<h:outputText value="#{result.valorTotalProdutoCarrinho}" style="text-align: right;" >
										<f:converter converterId="decimalConverter" />
									</h:outputText>
								</p:column>
					</p:dataTable>
				</div>
			</div>
		</div>
		<h:panelGrid id="lblTotalReg" cellpadding="0" cellspacing="0" columns="2"
			style="	margin-top:5px;">
			<h:outputLabel value="#{msgs['detalharvenda.lbl.totalprodutoscomprados']}:" />
			<h:outputLabel value="#{historicoVendaBean.numeroTotalProdutosVendidos}" styleClass="input-5left HtmlOutputTextResposta" />
		</h:panelGrid>
				
		
		<hr class="lin"/>

		<div class="buttonFooter">
			<h:panelGroup>
				<p:commandButton id="btnVoltar" value="#{msgs.btn_voltar}" ajax="false"
					action="#{historicoVendaBean.voltarTelaHistoricoVendas()}" styleClass="btn btn-zen-5 btn-toolbar botao-voltar"  />
				<div style="height: 10px;width: 10px;"></div>	
			</h:panelGroup>
		</div>
	</ui:define>
	
	<ui:define name="dialog">
	
		<p:dialog header="#{msgs['detalharvenda.lbl.dialog.pagarparcela']}"
			widgetVar="dialogPagamento" resizable="false" modal="true"
			showEffect="slide" width="700px" height="180px;">
			<h:panelGrid id="infoPagamento" columns="2"	style="margin-bottom:10px">

				<h:outputLabel value="#{msgs['detalharvenda.lbl.descricaoparcela']}:" for="txtParcela" styleClass="HtmlOutputLabelResposta" />
				<h:outputLabel id="txtParcela" value="#{historicoVendaBean.parcelaSelecionadaPagamento.descricao} - #{historicoVendaBean.parcelaSelecionadaPagamento.codSituacaoParcela.descSituacao}" 
						styleClass="input-5left HtmlOutputTextResposta" />

				<h:outputLabel value="#{msgs['detalharvenda.lbl.valorparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<h:panelGroup>
					<h:outputLabel value="R$" styleClass="input-5left HtmlOutputTextResposta" />
					<h:outputLabel value="#{historicoVendaBean.parcelaSelecionadaPagamento.valorParcela}" styleClass="input-5left HtmlOutputTextResposta" >
						<f:converter converterId="decimalConverter" />
					</h:outputLabel>
				</h:panelGroup>

				<h:outputLabel value="#{msgs['detalharvenda.lbl.datavencimentoparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<h:outputLabel value="#{historicoVendaBean.parcelaSelecionadaPagamento.dtVencimento}" styleClass="input-5left HtmlOutputTextResposta" >
					<f:convertDateTime pattern="dd/MM/yyyy"/> 
				</h:outputLabel>

				<h:outputLabel value="#{msgs['detalharvenda.lbl.datapagamentoparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<p:calendar id="calendarDataPagamento" value="#{historicoVendaBean.parcelaSelecionadaPagamento.dtPagamento}" size="15" 
					styleClass="input-5left" alt="date" pattern="dd/MM/yyyy" />
					
				<p:commandButton id="btnCancelar" value="#{msgs['btn_cancelar']}" ajax="false" immediate="true"
						actionListener="#{historicoVendaBean.btnCancelarModal()}"
						style="float:right;" styleClass="btn btn-zen-5 btn-toolbar" oncomplete="PF('dialogPagamento').hide();" />
				<p:commandButton
					update=":formGlobal:tableParcelas" 
					onclick="return validaDataPagamento(document.forms[2])"
					oncomplete="PF('dialogPagamento').hide();" styleClass="btn btn-zen-2 btn-toolbar"
					actionListener="#{historicoVendaBean.efetuarPagamentoParcela()}"
					value="#{msgs['detalharvenda.lbl.btn_efetuarpagamento']}" />
			</h:panelGrid>
		</p:dialog>
		
	</ui:define>
	
</ui:composition>
	

<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition template="/template/template_main.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="ccsImports">
	</ui:define>
	
	<ui:define name="jsImports">
		<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/javascript/menu_venda/validate_venda.js"></script>
	</ui:define>

	<ui:define name="breadcrumb">
		<ul class="breadcrumb">
			<li class="active">
				<h:commandLink action="#{loginBean.telaIndex()}" value="#{msgs['generico.breadcumb.telainicial']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{efetuarVendaBean.iniciarTela()}" value="#{msgs['dadosvenda.breadcumb.venda']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{efetuarVendaBean.voltarParaSelecionarClientes}" value="#{msgs['dadosvenda.breadcumb.venda.listarcliente']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{efetuarVendaBean.voltarParaSelecionarClientes}" value="#{msgs['dadosvenda.breadcumb.venda.cadastrarvenda.selecionarprodutos']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{efetuarVendaBean.voltarParaDadosDaVenda()}" value="#{msgs['dadosvenda.breadcumb.venda.cadastrarvenda.selecionarprodutos.dadosvenda']}" />
				<span class="divider">/</span>
			</li>
			<li>#{msgs['dadosvenda.breadcumb.venda.cadastrarvenda.selecionarprodutos.dadosvenda.finalizarvenda']}</li>
		</ul>
	</ui:define>

	<ui:define name="body_content">
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['dadosvenda.lbl.legend.informacaocliente']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">		
					<h:panelGrid cellpadding="0" cellspacing="1" columns="6" border="0" styleClass="" style="margin-top:5px;">
						<h:outputLabel value="#{msgs['dadosvenda.lbl.nome']}:" for="txtNome" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="txtNome" value="#{efetuarVendaBean.clienteVo.nome}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
						
						<h:outputLabel value="#{msgs['dadosvenda.lbl.endereco']}:" for="txtAddress" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="txtAddress" value="#{efetuarVendaBean.clienteVo.endereco.logradouro}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.numero']}:" for="txtNum" styleClass="HtmlOutputLabelResposta"/> 
						<h:outputLabel id="txtNum" value="#{efetuarVendaBean.clienteVo.endereco.numero}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.bairro']}:" for="txtBairro" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtBairro" value="#{efetuarVendaBean.clienteVo.endereco.bairro}" styleClass="input-5left HtmlOutputTextResposta"  />
			
						<h:outputLabel value="#{msgs['dadosvenda.lbl.cidade']}:" for="txtCity" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtCity" value="#{efetuarVendaBean.clienteVo.endereco.cidade}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.estado']}:" for="txtState" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtState" value="#{efetuarVendaBean.clienteVo.endereco.estado}" styleClass="input-5left HtmlOutputTextResposta"  />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.cep']}:" for="cep" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="cep" value="#{efetuarVendaBean.clienteVo.endereco.cep}" styleClass="input-5left HtmlOutputTextResposta"  />
						
						<h:outputLabel value="#{msgs['dadosvenda.lbl.email']}:" for="txtEmail" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtEmail" value="#{efetuarVendaBean.clienteVo.email}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.telefone']}:" for="txtTelefone" style="margin-left:20px;" styleClass="HtmlOutputLabelResposta"/>
						<h:outputLabel id="txtTelefone" value="#{efetuarVendaBean.clienteVo.numTelefoneString}" styleClass="input-5left HtmlOutputTextResposta" />
						<h:outputLabel value="#{msgs['dadosvenda.lbl.celular']}:" for="txtTelefoneCel" style="margin-left:20px;" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="txtTelefoneCel" value="#{efetuarVendaBean.clienteVo.numCelularString}" styleClass="input-5left HtmlOutputTextResposta" />
					
						<h:outputLabel value="#{msgs['dadosvenda.lbl.dataprimeiravenda']}:" for="calendarDtFirstSale" styleClass="HtmlOutputLabelResposta" rendered="#{not empty efetuarVendaBean.clienteVo.dataPrimeiraVenda}"/>
						<h:outputLabel id="calendarDtFirstSale" value="#{efetuarVendaBean.clienteVo.dataPrimeiraVendaFormatado}" styleClass="input-5left HtmlOutputTextResposta" rendered="#{not empty efetuarVendaBean.clienteVo.dataPrimeiraVenda}"/>
						<h:outputLabel value="#{msgs['dadosvenda.lbl.dataultimavenda']}:" for="calendarDtFirstSale" styleClass="HtmlOutputLabelResposta" rendered="#{not empty efetuarVendaBean.clienteVo.dataUltimaVenda}" />
						<h:outputLabel id="calendarDtLastSale" value="#{efetuarVendaBean.clienteVo.dataUltimaVendaFormatado}" styleClass="input-5left HtmlOutputTextResposta" rendered="#{not empty efetuarVendaBean.clienteVo.dataUltimaVenda}"/>
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
						<h:panelGroup></h:panelGroup>
					</h:panelGrid>
						
					<h:panelGrid cellpadding="0" cellspacing="1" columns="2" border="0" styleClass="" style="margin-bottom:25px;" >
						<p:selectBooleanCheckbox value="#{efetuarVendaBean.venda.acompanhamento222}" style="float:right;"/>
						<h:outputLabel value="#{msgs['finalizarvenda.lbl.acompanhamento222']}" style="margin-left:5px;"/>
					</h:panelGrid>
				</div>
			</div>
		</div>
				
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['dadosvenda.lbl.legend.informacaovenda']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">				
					<h:panelGrid columns="4" cellpadding="0" cellspacing="0">
						<h:outputLabel value="#{msgs['dadosvenda.lbl.valortotalvenda']}:" for="txtValorVenda" styleClass="HtmlOutputLabelResposta"/>
						<h:panelGrid columns="2">
							<h:outputLabel value="R$" for="txtValorVenda" styleClass="input-5left HtmlOutputTextResposta"/>
							<h:outputLabel id="txtValorVenda" value="#{efetuarVendaBean.venda.valorVenda}" styleClass="input-5left HtmlOutputTextResposta">
								<f:converter converterId="decimalConverter" />
							</h:outputLabel>
						</h:panelGrid>
						
						<h:outputLabel value="#{msgs['dadosvenda.lbl.lucroestimado']}:" for="txtValorTotalDesc" style="margin-left:20px;" styleClass="HtmlOutputLabelResposta" />
						<h:panelGrid columns="2" >
							<h:outputLabel value="R$" for="txtValorTotalDesc" styleClass="input-5left HtmlOutputTextResposta"/>
							<h:outputLabel value="#{efetuarVendaBean.venda.valorDescontoVenda}" id="txtValorTotalDesc" styleClass="input-5left HtmlOutputTextResposta">
								<f:converter converterId="decimalConverter" />
							</h:outputLabel>
						</h:panelGrid>
						
						<h:outputLabel value="#{msgs['dadosvenda.lbl.valortotalcobrar']}:" for="txtValorTotalPedido" styleClass="HtmlOutputLabelResposta" />
						<h:panelGrid columns="2" >
							<h:outputLabel value="R$" for="txtValorTotalPedido" styleClass="input-5left HtmlOutputTextResposta"/>
							<h:outputLabel value="#{efetuarVendaBean.totalAPagar}" id="txtValorTotalPedido" styleClass="input-5left HtmlOutputTextResposta">
								<f:converter converterId="decimalConverter" />
							</h:outputLabel>
						</h:panelGrid>
						
						<h:outputLabel value="#{msgs['dadosvenda.lbl.lucroestimado']}:" for="txtValorLucroEst" style="margin-left:20px;" styleClass="HtmlOutputLabelResposta" />
						<h:panelGrid columns="2" >
							<h:outputLabel value="R$" for="txtValorLucroEst" styleClass="input-5left HtmlOutputTextResposta"/>
							<h:outputLabel value="#{efetuarVendaBean.venda.valorLucroVenda}" id="txtValorLucroEst" styleClass="input-5left HtmlOutputTextResposta">
								<f:converter converterId="decimalConverter" />
							</h:outputLabel>
						</h:panelGrid>
					</h:panelGrid>
					
					<p:dataTable id="tableCatalogo"
						value="#{efetuarVendaBean.venda.listaDeProdutos}" var="result"
						rowKey="#{result}" 
						rows="10"
						styleClass="dataTable"
						paginator="true" paginatorPosition="bottom"
						emptyMessage="#{msgs['generico.mensagem.dadosnaoencontrados']}">

						<f:facet name="header">  
				            #{msgs['dadosvenda.lbl.produtosinclusoscarrinho']}
				        </f:facet>
				        
						<p:column headerText="#{msgs['generico.tabelacoluna.produto']}" width="30%">
							<h:outputText value="#{result.produto.descProduto}"
								style="text-align: left;" />
						</p:column>
						<p:column headerText="#{msgs['generico.tabelacoluna.totalpontosvendidos']}" style="text-align: center;" width="10%">
							<h:outputText value="#{result.somaPontosProdutoCarrinho} pts" style="text-align: center;" />
						</p:column>
						<p:column headerText="#{msgs['generico.tabelacoluna.valorunitario']}" style="text-align: center;"
							width="10%" 	>
							<h:outputText value="R$" style="text-align: center;" />
							<h:outputText value="#{result.produto.preco}"
								style="text-align: center;">
								<f:converter converterId="decimalConverter" />
							</h:outputText>
						</p:column>

						<p:column headerText="#{msgs['generico.tabelacoluna.quantidade']}" style="text-align: center;" width="5%" >
							<h:outputText value="#{result.qtdeProdutoCarrinho}" style="text-align: center;" />
						</p:column>

						<p:column headerText="#{msgs['generico.tabelacoluna.valortotal']}" style="text-align: center;" width="10%" >
							<h:outputText value="R$" style="text-align: right;" />
							<h:outputText value="#{result.valorTotalProdutoCarrinho}" style="text-align: right;">
								<f:converter converterId="decimalConverter" />
							</h:outputText>
						</p:column>
						
						<f:facet name="footer">
			                <h:outputText value="#{msgs['dadosvenda.lbl.totalprodutocarrinho']}:" /> 
				            <h:outputText value="#{efetuarVendaBean.totalProdutosVenda}" styleClass="input-5left"/>  
			             	<h:outputText style="margin-left:20px;" value="#{msgs['dadosvenda.lbl.valortotalpagar']}:" />  
			                <h:panelGroup>
								<h:outputText value="R$" styleClass="input-5left HtmlOutputTextResposta"/>
				                <h:outputText value="#{efetuarVendaBean.venda.valorVenda}" >
				                	<f:converter converterId="decimalConverter" />
				                </h:outputText>
				            </h:panelGroup>  
						</f:facet> 
							
					</p:dataTable>
				</div>
			</div>
		</div>
		
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharvenda.lbl.legend.informacaopagamento']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">			
					<h:panelGrid columns="3" style="margin: 0 auto;">
						<h:panelGroup >
							<h:panelGrid columns="1" >
								<h:outputLabel value="#{msgs['dadosvenda.lbl.formapagamento']}:" />
								<p:selectOneMenu id="cboFormaPgto" value="#{efetuarVendaBean.venda.formaPagamento}" styleClass="input-5left" converter="genericEntityConverter" >
									<f:selectItems value="#{efetuarVendaBean.cboFormaPagamento}" var="_fp" itemLabel="#{_fp.descFormaPgto}" itemValue="#{_fp}" />
									<p:ajax update="lblParcelamento" listener="#{efetuarVendaBean.onChangeFormaPagamento()}"/>
								</p:selectOneMenu>
								<h:panelGroup>
									<div style="height: 48px;width: 170px;"></div>
								</h:panelGroup>
							</h:panelGrid>
						</h:panelGroup>
						<h:panelGroup id="lblParcelamento" >
							<h:outputLabel value="#{msgs['dadosvenda.lbl.parcelamento']}:" />
							<p:selectOneListbox id="listPArcelamento" value="#{efetuarVendaBean.numParcelasPagamento}" styleClass="input-5left" style="width: 200px;height: 80px;" required="true" requiredMessage="Selecione a parcela desejada." >  
					            <f:selectItems value="#{efetuarVendaBean.listaParcelamentoSelectItem}" var="parc" itemLabel="#{parc.label}" itemValue="#{parc.value}" />  
					        </p:selectOneListbox>								
						</h:panelGroup>
						<h:panelGrid columns="1" >
							<h:outputLabel value="#{msgs['dadosvenda.lbl.datavencimentoparcela']}:" />
							<p:calendar id="txtDataVctoPrimeiraParcela" value="#{efetuarVendaBean.dtVctoPrimeiraParcela}" size="13"  pattern="dd/MM/yyyy" alt="date" />
							<h:panelGroup>
								<div style="height: 48px;width: 170px;"></div>
							</h:panelGroup>
						</h:panelGrid>
						<h:panelGroup  >
						</h:panelGroup>
					</h:panelGrid>
				</div>
			</div>
		</div>
		
		<hr class="lin" />
				
		<h:panelGroup>
			<div class="buttonFooter">
				<p:commandButton id="btnVoltar" value="#{msgs['btn_voltar']}" immediate="true" ajax="false" styleClass="btn btn-zen-5 btn-toolbar botao-voltar"
					action="#{efetuarVendaBean.voltarParaDadosDaVenda()}"  />
				<p:commandButton id="btnConcluirVenda" 
								 value="#{msgs['dadosvenda.lbl.btn_concluirvenda']}"
								 ajax="false" styleClass="btn btn-zen-2 btn-toolbar"
								 action="#{efetuarVendaBean.navegarConcluirVenda()}" 
								 onclick="return validarConcluirVenda(document.forms[1])" >
				 </p:commandButton>
			</div>
			<div style="height: 10px;width: 10px;"></div>			    
		</h:panelGroup>
				
		
		
	</ui:define>

</ui:composition>
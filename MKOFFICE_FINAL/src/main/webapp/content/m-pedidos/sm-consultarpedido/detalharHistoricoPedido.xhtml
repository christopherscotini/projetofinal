<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition template="/template/template_main.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="cssImports">
	</ui:define>
	
	<ui:define name="jsImports">
	</ui:define>

	<ui:define name="breadcrumb">
		<ul class="breadcrumb">
			<li class="active">
				<h:commandLink action="#{loginBean.telaIndex()}" value="#{msgs['generico.breadcumb.telainicial']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{historicoPedidoBean.iniciarTela()}" value="#{msgs['detalharhistoricopedido.breadcumb.pedido']}" />
				<span class="divider">/</span>
			</li>
			<li class="active">
				<h:commandLink action="#{historicoPedidoBean.navegarVoltarDetalhePedido()}" value="#{msgs['detalharhistoricopedido.breadcumb.pedido.listarhistoricopedido']}" />
				<span class="divider">/</span>
			</li>
			<li>#{msgs['detalharhistoricopedido.breadcumb.pedido.listarhistoricopedido.detalharpedido']}</li>
		</ul>
	</ui:define>
	
	<ui:define name="body_content">
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharhistoricopedido.lbl.legend.informacaopedido']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">
					<h:panelGrid cellpadding="0" cellspacing="0" columns="4" border="0" style="margin-top:5px;margin-bottom:25px;">
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.numeropedido']}:" for="txtNumPedido" styleClass="HtmlOutputLabelResposta"/>
							<h:outputLabel id="txtNumPedido" value="#{historicoPedidoBean.pedidoSelecionado.codPedido}" styleClass="input-5left HtmlOutputTextResposta" />
							
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.valorpedido']}:" for="txtValorPedido" styleClass="HtmlOutputLabelResposta" />
							<h:panelGrid columns="2">
								<h:outputLabel value="R$" for="txtValorPedido" styleClass="input-5left HtmlOutputTextResposta"/>
								<h:outputLabel id="txtValorPedido" value="#{historicoPedidoBean.pedidoSelecionado.valorTotalEmProdutos}" styleClass="input-5left HtmlOutputTextResposta">
									<f:converter converterId="decimalConverter" />
								</h:outputLabel>
							</h:panelGrid>	
							
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.datapedido']}:" for="txtDataPedido" styleClass="HtmlOutputLabelResposta"/>
							<h:outputLabel id="txtDataPedido" value="#{historicoPedidoBean.pedidoSelecionado.dtPedidoFormatado}" styleClass="input-5left HtmlOutputTextResposta" />
							
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.percentualdesconto']}:" for="txtPercDesconto" styleClass="HtmlOutputLabelResposta" style="margin-left:10px;"/>
							<h:outputLabel value="#{historicoPedidoBean.pedidoSelecionado.porcDesconto}%" id="txtPercDesconto" styleClass="input-5left HtmlOutputTextResposta" />
	
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.totalpontos']}:" for="txtTotPontos" styleClass="HtmlOutputLabelResposta"/>
							<h:outputLabel value="#{historicoPedidoBean.pedidoSelecionado.pontosTotalPedido} pts" id="txtTotPontos" styleClass="input-5left HtmlOutputTextResposta" />
							
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.valorbonusutilizado']}:" for="txtValorBonusUtilizado" styleClass="HtmlOutputLabelResposta"/>
							<h:panelGrid columns="2">
								<h:outputLabel value="R$" for="txtValorBonusUtilizado" styleClass="input-5left HtmlOutputTextResposta" />
								<h:outputLabel id="txtValorBonusUtilizado" value="#{historicoPedidoBean.pedidoSelecionado.valorBonusUtilizado}" styleClass="input-5left HtmlOutputTextResposta">
									<f:converter converterId="decimalConverter" />
								</h:outputLabel>
							</h:panelGrid>
							
							<h:panelGroup>	</h:panelGroup>						
							<h:panelGroup>	</h:panelGroup>						
	
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.valorfrete']}:" for="txtValorFrete" styleClass="HtmlOutputLabelResposta"/>
							<h:panelGrid columns="2">
								<h:outputLabel value="R$" for="txtValorFrete" styleClass="input-5left HtmlOutputTextResposta"/>
								<h:outputLabel value="#{historicoPedidoBean.pedidoSelecionado.valorFrete}" id="txtValorFrete" styleClass="HtmlOutputTextResposta" >
									<f:converter converterId="decimalConverter" />
								</h:outputLabel>
							</h:panelGrid>						
							
							<h:panelGroup>	</h:panelGroup>						
							<h:panelGroup>	</h:panelGroup>						
							
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.valortotalpagar']}:" for="txtValorTotalPedido" styleClass="HtmlOutputLabelResposta"/>
							<h:panelGrid columns="2">
								<h:outputLabel value="R$" for="txtValorTotalPedido" styleClass="input-5left HtmlOutputTextResposta"/>
								<h:outputLabel value="#{historicoPedidoBean.pedidoSelecionado.valorFinalTotalPago}" id="txtValorTotalPedido" styleClass="HtmlOutputTextResposta">
									<f:converter converterId="decimalConverter" />
								</h:outputLabel>
							</h:panelGrid>
							
							<h:panelGroup>	</h:panelGroup>						
							<h:panelGroup>	</h:panelGroup>						
	
							<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.lucroestimado']}:" for="txtLucroTotalPedido" styleClass="HtmlOutputLabelResposta"/>
							<h:panelGrid columns="2">
								<h:outputLabel value="R$" for="txtLucroTotalPedido" styleClass="input-5left HtmlOutputTextResposta"/>
								<h:outputLabel value="#{historicoPedidoBean.pedidoSelecionado.lucroTotal}" id="txtLucroTotalPedido" styleClass="HtmlOutputTextResposta">
									<f:converter converterId="decimalConverter" />
								</h:outputLabel>
							</h:panelGrid>
							
					</h:panelGrid>
				</div>
			</div>
		</div>
			
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharhistoricopedido.lbl.legend.informacaopagamento']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">		
					<h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="margin-top:5px;">
						<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.formapagamento']}:" for="txtFormaPagamento" styleClass="HtmlOutputLabelResposta" />
						<h:outputLabel id="txtFormaPagamento" value="#{historicoPedidoBean.pedidoSelecionado.formaDePagamento.descFormaPgto}" styleClass="input-5left HtmlOutputTextResposta" />
					</h:panelGrid>
	
					<p:dataTable id="tableParcelas" style="width:42%"
							value="#{historicoPedidoBean.pedidoSelecionado.parcelas}" var="p"
							rowKey="#{p}" rows="10"
							styleClass="dataTable"
							emptyMessage="#{msgs['generico.mensagem.naohaparcelas']}" >
		
							<f:facet name="header">  
					            #{msgs['detalharhistoricopedido.titulotabela.situacaoparcelas']}
					        </f:facet>
					        
							<p:column headerText="#{msgs['generico.tabelacoluna.situacao']}">
					        	<h:outputText value="#{p.descricao} - #{p.codSituacaoParcela.descSituacao}" />
					        </p:column>
							<p:column  style="text-align: center;" headerText="VALOR DA PARCELA" >
					        	<h:outputText value="R$"
									style="text-align: center;" />
					        	<h:outputText value="#{p.valorParcela}"
									style="text-align: center;">
									<f:converter converterId="decimalConverter" />
								</h:outputText>
					        </p:column>
							<p:column headerText="#{msgs['generico.tabelacoluna.datavencimento']}" style="text-align: center;"  >
					        	<h:outputText value="#{p.dtVencimento}" style="text-align: center;">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
					        </p:column>
					        <p:column headerText="#{msgs['generico.tabelacoluna.datapagamento']}" style="text-align: center;"  >
					        	<h:outputText value="#{p.dtPagamento}" style="text-align: center;">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
					        </p:column>
							<p:column  style="text-align: center;" headerText="STATUS" width="500px">
								<p:commandLink 
									 disabled="#{p.desabilitaPagamentoParcela}"
									 value="#{p.codSituacaoParcela.descSituacao}" 
									 actionListener="#{historicoPedidoBean.onclickBtnPagamentoParcela(p)}"
									 update=":formDialog:infoPagamento"
									 oncomplete="PF('dialogPagamento').show();loadMasksJQuery();" /> 
					        </p:column>
					</p:dataTable>
				</div>
			</div>
		</div>
			
		<div class="widget">
			<div class="widget-heading">
				<a class="accordion-toggle in" data-toggle="collapse" href="#si" data-original-title="">
				<i class="icon-table"></i> #{msgs['detalharhistoricopedido.lbl.legend.listaprodutosinclusospedido']}</a>
			</div>
			<div id="si" class="widget-body collapse in">
				<div class="widget-inner">
					<p:dataTable id="tableProdutosComprados"
							value="#{historicoPedidoBean.pedidoSelecionado.listaProdutosComprados}" var="result"
							rowKey="#{result}" 
							rows="10"
							editable="true" editMode="cell"
							styleClass="dataTable"
							paginator="true" paginatorPosition="bottom"
							emptyMessage="#{msgs['generico.mensagem.dadosnaoencontrados']}">
	
							
							<p:column headerText="#{msgs['generico.tabelacoluna.codigoproutomk']}" style="text-align: center;"
									width="10%" sortBy="#{result.produto.codProduto}">
									<h:outputText value="#{result.produto.codProduto}"
										style="text-align: center;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.produto']}" width="60%" sortBy="#{result.produto.descProduto}">
									<h:outputText value="#{result.produto.descProduto}"
										style="text-align: left;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.valorunitario']}" style="text-align: center;" width="15%" 
									sortBy="#{result.produto.preco}">
									<h:outputText value="R$" style="text-align: right;" />
									<h:outputText value="#{result.produto.preco}" style="text-align: right;" >
										<f:converter converterId="decimalConverter" />
									</h:outputText>
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.quantidade']}" style="text-align: center;" width="10%" sortBy="#{result.qtdeProdutoCarrinho}" >
									<h:outputText value="#{result.qtdeProdutoCarrinho}" style="text-align: center;" />
								</p:column>
								<p:column headerText="#{msgs['generico.tabelacoluna.valortotal']}" style="text-align: center;" width="10%" >
									<h:outputText value="R$" style="text-align: right;" />
									<h:outputText value="#{result.valorTotalProdutoCarrinho}" style="text-align: right;" >
										<f:converter converterId="decimalConverter" />
									</h:outputText>
								</p:column>
					</p:dataTable>
				</div>
			</div>
		</div>
					
		<hr class="lin"></hr>
					
		<h:panelGroup>
			<div class="buttonFooter">
				<p:commandButton id="btnVoltar" value="#{msgs.btn_voltar}" ajax="false" styleClass="btn btn-zen-5 btn-toolbar botao-voltar"
					action="#{historicoPedidoBean.navegarVoltarDetalhePedido()}"  />
				<div style="height: 10px;width: 10px;"></div>	
			</div>
		</h:panelGroup>
					
		
	</ui:define>
	
	<ui:define name="dialog">
		<p:dialog header="#{msgs['detalharhistoricopedido.lbl.dialog.pagarparcela']}"
			widgetVar="dialogPagamento" resizable="false" modal="true"
			showEffect="slide" width="700px" height="180px;">
			<h:panelGrid id="infoPagamento" columns="2"	style="margin-bottom:10px">

				<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.descricaoparcela']}:" for="txtParcela" styleClass="HtmlOutputLabelResposta" />
				<h:outputLabel id="txtParcela" value="#{historicoPedidoBean.parcelaSelecionadaPagamento.descricao} - #{historicoPedidoBean.parcelaSelecionadaPagamento.codSituacaoParcela.descSituacao}" 
						styleClass="input-5left HtmlOutputTextResposta" />

				<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.valorparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<h:panelGroup>
					<h:outputLabel value="R$" styleClass="input-5left HtmlOutputTextResposta" />
					<h:outputLabel value="#{historicoPedidoBean.parcelaSelecionadaPagamento.valorParcela}" styleClass="input-5left HtmlOutputTextResposta" >
						<f:converter converterId="decimalConverter" />
					</h:outputLabel>
				</h:panelGroup>

				<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.datavencimentoparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<h:outputLabel value="#{historicoPedidoBean.parcelaSelecionadaPagamento.dtVencimento}" styleClass="input-5left HtmlOutputTextResposta" >
					<f:convertDateTime pattern="dd/MM/yyyy"/> 
				</h:outputLabel>

				<h:outputLabel value="#{msgs['detalharhistoricopedido.lbl.datapagamentoparcela']}:" styleClass="HtmlOutputLabelResposta" />
				<p:calendar id="calendarDataPagamento" value="#{historicoPedidoBean.parcelaSelecionadaPagamento.dtPagamento}" size="15" 
					styleClass="input-5left" alt="date" pattern="dd/MM/yyyy" />
					
				<p:commandButton id="btnCancelar" value="#{msgs.btn_cancelar}" styleClass="btn btn-zen-5 btn-toolbar"
						style="float:right;" oncomplete="PF('dialogPagamento').hide();" />
				<p:commandButton
					update=":formGlobal:tableParcelas" 
					onclick="return validaDataPagamento(document.forms[2])"
					oncomplete="PF('dialogPagamento').hide();"
					styleClass="btn btn-zen-2 btn-toolbar"
					actionListener="#{historicoPedidoBean.efetuarPagamentoParcela()}"
					value="#{msgs['detalharhistoricopedido.lbl.btn_efetuarpagamento']}" />
					
			</h:panelGrid>
		</p:dialog>
		
	</ui:define>
	

</ui:composition>
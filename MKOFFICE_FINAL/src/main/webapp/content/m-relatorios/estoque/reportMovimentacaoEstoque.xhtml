<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition template="/template/template_main.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="cssImports">
		<link type="text/css" rel="stylesheet"
			href="#{facesContext.externalContext.requestContextPath}/css/cadastro/clientes.css" />
	</ui:define>

	<ui:define name="jsImports">
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/menu_venda/validate_venda.js"></script>
	</ui:define>

	<ui:define name="breadcrumb">
		<p:breadCrumb>
			<p:menuitem value="TelaInicial"
				action="#{reportEstoqueBean.scheduleBean.telaInicial()}"
				ajax="false" />
			<p:menuitem value="Relatórios" />
			<p:menuitem value="Relátório de Movimentação de estoque" />
		</p:breadCrumb>
	</ui:define>

	<ui:param name="titulo" value="Relatório de Movimentação de estoque"></ui:param>

	<ui:define name="body_content">

		<h:panelGrid cellpadding="0" cellspacing="0" columns="1"
			styleClass="CorpoPagina" border="0">
			<p:fieldset legend="FILTRO">
				<h:panelGroup id="tabela-filtro-relatorio">
					<h:panelGrid cellpadding="1" cellspacing="0" columns="4" border="0">
						<h:outputLabel for="txtTipoFluxoDialogEstoque"
							value="Tipo de Fluxo:" styleClass="" style="" />
						<p:selectOneMenu id="txtTipoFluxoDialogEstoque"
							value="#{reportEstoqueBean.tipoFluxoEstoqueFiltro}"
							style="width:300px;" converter="genericEntityConverter">
							<f:selectItems value="#{reportEstoqueBean.listaFluxoEstoque}"
								var="c" itemLabel="#{c.descFluxoEstoque}" itemValue="#{c}" />
						</p:selectOneMenu>
						<h:panelGroup> 	</h:panelGroup>
						<h:panelGroup>	</h:panelGroup>

						<p:outputLabel value="Data Inicial:" styleClass="HtmlOutputLabelResposta" />
						<h:panelGroup>
							<p:calendar id="calendarDataInicial"
								value="#{reportEstoqueBean.dataInicial}" alt="date"
								pattern="dd/MM/yyyy" size="10" />
							<p:outputLabel value="Data Final:" styleClass=""
								style="margin-left:8px;" />
							<p:calendar id="calendarDataFinal"
								value="#{reportEstoqueBean.dataFinal}" alt="date" size="10"
								pattern="dd/MM/yyyy" />
						</h:panelGroup>

					</h:panelGrid>
				</h:panelGroup>
				<h:panelGroup>
					<div class="buttonFilter">
						<p:commandButton value="#{msgs.btn_limpar}"
							action="#{reportEstoqueBean.limparCamposFiltro()}" ajax="true"
							update="tabela-filtro-relatorio" />
						<p:commandButton value="#{msgs.btn_pesquisar}"
							action="#{reportEstoqueBean.pesquisarFiltro()}" ajax="true"
							onclick="return validarPesquisaHistoricoVendas(document.forms[1])"
							update="messagesGlobal :formGlobal:tabela-listagem-vendas"
							style="margin-left:5px;" />
					</div>
				</h:panelGroup>
			</p:fieldset>

			<hr class="lin" />

			<h:panelGroup id="tabela-listagem-vendas">
				<h:panelGrid cellpadding="0" cellspacing="0" columns="1"
					styleClass="centralizar-conteudo">
					<p:dataTable id="tbl-relatorio"
						value="#{reportEstoqueBean.listaMovimentacaoHistorico}"
						var="result" paginator="true" paginatorPosition="bottom"
						style="margin-top:20px" emptyMessage="Dados não encontrados"
						rows="10" sortBy="#{result.dataMovimento}" sortOrder="ascending">

						<p:column headerText="PRODUTO">
							<f:facet name="header">
								 <h:outputText value="PRODUTO" rendered="true"/>
							</f:facet>
							<h:outputText value="#{result.produto}" />
						</p:column>

						<p:column headerText="TIPO DE MOVIMENTO"
							style="text-align: center;">
							<f:facet name="header">
								 <h:outputText value="TIPO DE MOVIMENTO" rendered="true"/>
							</f:facet>
							<h:outputText value="#{result.tipoMovimento}"
								style="text-align: center;" />
						</p:column>

						<p:column headerText="DATA" style="text-align: center;">
							<f:facet name="header">
								 <h:outputText value="DATA" rendered="true"/>
							</f:facet>
							<h:outputText value="#{result.dataMovimento}"
								style="text-align: center;">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</p:column>

						<p:column headerText="QUANTIDADE" style="text-align: center;">
							<f:facet name="header">
								 <h:outputText value="QUANTIDADE" rendered="true"/>
							</f:facet>
							<h:outputText value="#{result.quantidadeMovimentado}"
								style="text-align: center;" />
						</p:column>
						<p:column headerText="VALOR" style="text-align: center;"
							width="10%">
							<f:facet name="header">
								 <h:outputText value="VALOR" rendered="true"/>
							</f:facet>
							<h:outputLabel value="R$" style="text-align: center;" />
							<h:outputText value="#{result.valorMovimentado}"
								style="text-align: center;">
								<f:converter converterId="decimalConverter" />
							</h:outputText>
						</p:column>
						
						<p:summaryRow>
				            <p:column colspan="4" style="text-align:right">
				                Total:
				            </p:column>
				
				            <p:column style="text-align: center;">
								<h:outputLabel value="R$" style="text-align: center;" />
								<h:outputText value="#{reportEstoqueBean.valorTotalMovimentado}"
									style="text-align: center;">
									<f:converter converterId="decimalConverter" />
								</h:outputText>
				            </p:column>
				        </p:summaryRow>
						
					</p:dataTable>
				</h:panelGrid>

				<h:panelGrid id="painel-importacao" columns="1" styleClass="centralizar-conteudo" rendered="#{not empty reportEstoqueBean.listaMovimentacaoHistorico}" >
					<p:panel header="Exportar dados para:">
<!-- 						<p:commandLink ajax="false" > -->
<!-- 							<p:graphicImage value="/images/excel.png" /> -->
<!-- 							<p:fileDownload value="#{reportEstoqueBean.generateReportXLS()}" /> -->
<!-- 						</p:commandLink> -->

						<p:commandLink ajax="false">
							<p:graphicImage value="/images/pdf.png" />
							<p:fileDownload value="#{reportEstoqueBean.generateReportPDF()}" />
						</p:commandLink>
					</p:panel>
				</h:panelGrid>

			</h:panelGroup>

			<hr class="lin" />

			<h:panelGroup>
				<div class="buttonFooter">
					<p:commandButton id="btnVoltar" value="#{msgs.btn_voltar}"
						style="float:left;" action="/index" ajax="false" />
				</div>
				<div style="height: 10px; width: 10px;"></div>
			</h:panelGroup>

		</h:panelGrid>

	</ui:define>
</ui:composition>
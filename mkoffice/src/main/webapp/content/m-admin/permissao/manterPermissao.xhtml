<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition template="/template/template_main.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="cssImports">
	</ui:define>
	
	<ui:define name="jsImports">
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/javascript/menu_admin/manter-permissao.js"></script>
	</ui:define>

	<ui:define name="breadcrumb">
		<p:breadCrumb>  
		    <p:menuitem value="TelaInicial" action="#{clienteBean.scheduleBean.telaInicial()}" ajax="false"/>
		    <p:menuitem value="Painel de Configuração" />  
		    <p:menuitem value="Usuario"  />  
		    <p:menuitem value="Manter Permissoes"  />  
		</p:breadCrumb>  
	</ui:define>
	<ui:param name="titulo" value="Manter Permissoes" />

	<ui:define name="body_content">
		<h:panelGrid cellpadding="0" cellspacing="0" columns="1" styleClass="CorpoPagina" border="0" >
			<p:fieldset legend="BUSCA" toggleable="true" collapsed="true">
				<h:panelGroup id="tabela-filtro-usuarios" >
					<h:panelGrid cellpadding="1" cellspacing="0" columns="4" border="0">
						<p:outputLabel value="Usuario:" for="txtUsuario" styleClass="HtmlOutputLabelResposta" />
						<p:inputText id="txtUsuario" value="#{permissaoBean.permissaoFiltro}" size="30" maxlength="45" styleClass="input-5left"/>
					</h:panelGrid>
				</h:panelGroup>
				
				<h:panelGroup >
					<div class="buttonFilter">
						<p:commandButton value="#{msgs.btn_limpar}" action="#{permissaoBean.limparCamposFiltro()}" ajax="true" style="margin-left:5px;" update="tabela-filtro-usuarios" />
						<p:commandButton value="#{msgs.btn_pesquisar}" action="#{permissaoBean.pesquisarFiltro()}" ajax="true" update="messagesGlobal tabela-listagem-permissoes lblTotalReg" style="margin-left:5px;" />
					</div>
				</h:panelGroup>
			</p:fieldset>
			
			<hr class="lin" />
			
			<h:panelGroup id="tabela-listagem-permissoes" >
				<h:panelGrid cellpadding="0" cellspacing="0" columns="1" styleClass="centralizar-conteudo" >
					<p:dataTable id="tableUsuarios" 
							style="margin-top:20px;"
							var="result" 
							rows="10" 
							rowKey="#{result}" 
							selectionMode="single"
							selection="#{permissaoBean.permissaoSelecionada}"
							value="#{permissaoBean.permissoes}" 
							paginator="true"
							paginatorPosition="bottom" 
							emptyMessage="">

						<p:ajax event="rowSelect" update=":formGlobal:btnAlterar :formGlobal:btnLimpar" />
						<p:ajax event="rowUnselect" update=":formGlobal:btnAlterar :formGlobal:btnLimpar" />
	
						<f:facet name="header">  
				           Permissões Cadastradas
				        </f:facet>
				        
						<p:column headerText="PERMISSÃO" width="30%" style="text-align: center;" sortBy="#{result.descPermissao}">
							<h:outputLabel value="#{result.descPermissao}"
								style="text-align: center;" />
						</p:column>
						
					</p:dataTable>
					
					<h:panelGroup>
						<h:panelGrid id="lblTotalReg" cellpadding="0" cellspacing="0" columns="2"
								style="	margin-top:5px;">
								<p:outputLabel value="Total de permissoes cadastradas:" />
								<p:outputLabel value="#{permissaoBean.permissoes.size()}" styleClass="input-5left HtmlOutputTextResposta" />
						</h:panelGrid>
					</h:panelGroup>
						
				</h:panelGrid>
			</h:panelGroup>
		
			<hr class="lin" />
			
			<h:panelGroup id="group-botoes-footer">
				<div class="buttonFooter" >
					<p:commandButton id="btnVoltar" value="#{msgs.btn_voltar}"
						style="float:left;" action="/index" ajax="false" />
					<p:commandButton id="btnLimpar" value="Limpar usuario selecionado"
						action="#{permissaoBean.limparSelecaoTabela()}" ajax="true" disabled="#{empty permissaoBean.permissaoSelecionada}"
						style="margin-left:5px;" update="tabela-listagem-permissoes group-botoes-footer" />
					
					<p:commandButton id="btnAlterar" value="#{msgs.btn_alterar}"
						action="#{permissaoBean.navegarAlterarPermissao()}" ajax="true" 
						disabled="#{empty permissaoBean.permissaoSelecionada}" 
						style="margin-left:5px;"
					 	update=":formDialog:infosPermissao"
						oncomplete="dialogPermissao.show();loadMasksJQuery();" />
					
					<p:commandButton id="btnCadastrar" value="#{msgs.btn_cadastrar}"
						action="#{permissaoBean.navegarIncluirPermissao()}" ajax="true"
						style="margin-left:5px;"
					 	update=":formDialog:infosPermissao"
						oncomplete="dialogPermissao.show();loadMasksJQuery();" />
				</div>
				<div style="height: 10px;width: 10px;"></div>
			</h:panelGroup>
		
		</h:panelGrid>
	</ui:define>
	
	
	<ui:define name="dialog">
		<p:dialog header="#{permissaoBean.tituloTelaIncAltPermissao}"
			widgetVar="dialogPermissao" resizable="false" modal="true"
			showEffect="slide" width="500" height="180px;">
			<h:panelGrid id="infosPermissao" columns="2"
				style="margin-bottom:10px">

				<p:outputLabel value="Permissao:" for="txtPermissao" styleClass="HtmlOutputLabelResposta" />
				<p:inputText id="txtPermissao" value="#{permissaoBean.permissao.descPermissao}" size="50" styleClass="input-5left" required="true" requiredMessage="O campo PERMISSÃO é necessário." >
					<f:validateLength minimum="3" for="txtUsuario"/>
				</p:inputText>

				<p:commandButton id="btnCancelar" value="Cancelar"
						style="float:right;" oncomplete="dialogPermissao.hide();" />
				<p:commandButton
					update=":formGlobal:tabela-listagem-permissoes :formGlobal:lblTotalReg"
					onclick="return validateForm(document.forms[2])"
					oncomplete="dialogPermissao.hide();"
					actionListener="#{permissaoBean.executeSave()}"
					value="Manter Permissão" />
			</h:panelGrid>
		</p:dialog>
	</ui:define>


	</ui:composition>